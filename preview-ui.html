<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumi Ofertas - Preview</title>
    <link rel="stylesheet" href="chrome/popup.css">
    <style>
        body {
            background-color: #333;
            /* Override popup.css width */
            width: 100% !important;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .preview-container {
            /* Use css vars from popup.css */
            background: var(--bg);
            width: 320px;
            /* Match extension width */

            min-height: 400px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            border-radius: 0;
            /* Extensions usually don't have radius themselves, but window does. */
            overflow: hidden;
            position: relative;
        }

        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        button.debug-btn {
            padding: 8px 12px;
            cursor: pointer;
            background: #eee;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        button.debug-btn:hover {
            background: #ddd;
        }
    </style>
</head>

<body>

    <div class="controls">
        <strong>Controles de Preview</strong>
        <button class="debug-btn" onclick="showLogin()">Ver Login</button>
        <button class="debug-btn" onclick="showStatus()">Ver Status (Logado)</button>
        <button class="debug-btn" onclick="toggleError()">Simular Erro</button>

        <hr style="width:100%; border:0; border-top:1px solid #ccc; margin:10px 0;">

        <strong>Simulador de Badges</strong>
        <div style="display:flex; gap:10px; align-items:center; margin-top:5px;">
            <div id="icon-preview"
                style="width:32px; height:32px; background:#7C3AED; border-radius:6px; position:relative; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; font-family:sans-serif;">
                L
                <span id="badge-preview"
                    style="position:absolute; bottom:-4px; right:-4px; background:#10B981; color:white; font-size:10px; padding:2px 4px; border-radius:4px; font-weight:bold; box-shadow: 0 0 0 1px white;">‚úì</span>
            </div>
            <div style="display:flex; flex-direction:column; gap:5px;">
                <button class="debug-btn" style="font-size:10px" onclick="updateBadge('‚úì', '#10B981')">Sucesso
                    (‚úì)</button>
                <button class="debug-btn" style="font-size:10px" onclick="updateBadge('!', '#EF4444')">Erro (!)</button>
                <button class="debug-btn" style="font-size:10px" onclick="updateBadge('0', '#F59E0B')">Zero (0)</button>
            </div>
        </div>
    </div>

    <div class="preview-container">
        <!-- COPY OF POPUP.HTML CONTENT START -->
        <div class="container">
            <header>
                <div class="header-content">
                    <div class="logo-area">
                        <h1>Lumi Ofertas</h1>
                        <span class="version">v1.0.0</span>
                    </div>
                    <button id="theme-toggle" class="btn-icon" title="Alternar Tema">üåì</button>
                </div>
            </header>

            <main>
                <!-- LOGIN SCREEN -->
                <div id="login-screen" class="">
                    <p class="intro">Entre com sua conta Lumi Ofertas para sincronizar.</p>
                    <form id="login-form" onsubmit="event.preventDefault(); showStatus();">
                        <div class="form-group">
                            <label for="email">E-mail</label>
                            <input type="email" id="email" placeholder="seu@email.com" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Senha</label>
                            <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        </div>

                        <button type="submit" id="login-btn" class="btn-primary">Entrar</button>
                        <div id="login-error" class="error-msg hidden">Erro ao logar</div>
                    </form>
                </div>

                <!-- STATUS SCREEN -->
                <div id="status-screen" class="hidden">
                    <div class="user-info">
                        <div class="avatar">üë§</div>
                        <div class="details">
                            <strong id="user-name">Usu√°rio Exemplo</strong>
                            <small id="user-email">usuario@exemplo.com</small>
                        </div>
                        <button id="logout-btn" class="btn-icon" title="Sair" onclick="showLogin()">üö™</button>
                    </div>

                    <div class="status-card">
                        <div class="status-row header-row">
                            <span class="label">√öltima Sincroniza√ß√£o</span>
                            <span id="last-sync" class="value">Hoje, 10:45</span>
                        </div>

                        <div class="divider"></div>

                        <!-- Mercado Livre Row -->
                        <div class="platform-row">
                            <div class="plat-info">
                                <span class="plat-icon">ü§ù</span>
                                <span class="plat-name">Mercado Livre</span>
                            </div>
                            <div class="plat-status">
                                <span id="status-ml" class="badge badge-success">Conectado</span>
                                <span id="count-ml" class="cookie-count" title="Cookies">12</span>
                            </div>
                        </div>

                        <!-- Amazon Row -->
                        <div class="platform-row">
                            <div class="plat-info">
                                <span class="plat-icon">üõí</span>
                                <span class="plat-name">Amazon</span>
                            </div>
                            <div class="plat-status">
                                <span id="status-amz" class="badge badge-warning">Desconectado</span>
                                <span id="count-amz" class="cookie-count" title="Cookies">0</span>
                            </div>
                        </div>
                    </div>
                    <div id="sync-error-row" class="error-box hidden">
                        <strong>Erro:</strong> <span id="sync-error">Falha na conex√£o</span>
                    </div>

                    <button id="sync-btn" class="btn-primary full-width" onclick="simulateSync()">
                        üîÑ Sincronizar Agora
                    </button>
                </div>
            </main>

            <footer>
                <p>Lumi Ofertas Sync</p>
            </footer>
        </div>
        <!-- COPY OF POPUP.HTML CONTENT END -->
    </div>

    <script>
        const loginScreen = document.getElementById('login-screen');
        const statusScreen = document.getElementById('status-screen');
        const errorRow = document.getElementById('sync-error-row');
        const syncBtn = document.getElementById('sync-btn');

        function showLogin() {
            loginScreen.classList.remove('hidden');
            statusScreen.classList.add('hidden');
        }

        function showStatus() {
            loginScreen.classList.add('hidden');
            statusScreen.classList.remove('hidden');
        }

        function toggleError() {
            errorRow.classList.toggle('hidden');
        }

        function simulateSync() {
            const originalText = syncBtn.innerText;
            syncBtn.innerText = '‚è≥ Sincronizando...';
            // syncBtn.disabled = true;

            setTimeout(() => {
                syncBtn.innerText = originalText;
                syncBtn.disabled = false;
                alert('Sync simulado com sucesso!');
            }, 1500);
        }

        function updateBadge(text, color) {
            const badge = document.getElementById('badge-preview');
            badge.innerText = text;
            badge.style.backgroundColor = color;
        }

        // Theme Toggle Logic for Preview
        const themeToggle = document.getElementById('theme-toggle');
        function toggleTheme() {
            const current = document.body.classList.contains('dark') ? 'dark' :
                document.body.classList.contains('light') ? 'light' : 'system';

            let next = 'system';
            if (current === 'system') {
                const systemDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
                next = systemDark ? 'light' : 'dark';
            } else if (current === 'dark') {
                next = 'light';
            } else {
                next = 'dark';
            }

            document.body.className = next;
            // Also update the preview container if needed, but body class should handle it via CSS vars
        }
        themeToggle.addEventListener('click', toggleTheme);
    </script>
</body>

</html>